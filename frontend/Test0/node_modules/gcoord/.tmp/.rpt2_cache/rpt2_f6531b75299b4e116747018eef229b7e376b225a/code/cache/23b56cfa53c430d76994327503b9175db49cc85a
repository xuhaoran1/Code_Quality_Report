{"code":"var sin = Math.sin, cos = Math.cos, sqrt = Math.sqrt, abs = Math.abs, PI = Math.PI;\r\nvar a = 6378245;\r\nvar ee = 0.006693421622965823;\r\nexport function GCJ02ToWGS84(coord) {\r\n    var lon = coord[0], lat = coord[1];\r\n    if (!isInChinaBbox(lon, lat))\r\n        return [lon, lat];\r\n    var _a = [lon, lat], wgsLon = _a[0], wgsLat = _a[1];\r\n    var tempPoint = WGS84ToGCJ02([wgsLon, wgsLat]);\r\n    var dx = tempPoint[0] - lon;\r\n    var dy = tempPoint[1] - lat;\r\n    while (abs(dx) > 1e-6 || abs(dy) > 1e-6) {\r\n        wgsLon -= dx;\r\n        wgsLat -= dy;\r\n        tempPoint = WGS84ToGCJ02([wgsLon, wgsLat]);\r\n        dx = tempPoint[0] - lon;\r\n        dy = tempPoint[1] - lat;\r\n    }\r\n    return [wgsLon, wgsLat];\r\n}\r\nexport function WGS84ToGCJ02(coord) {\r\n    var lon = coord[0], lat = coord[1];\r\n    if (!isInChinaBbox(lon, lat))\r\n        return [lon, lat];\r\n    var d = delta(lon, lat);\r\n    return [lon + d[0], lat + d[1]];\r\n}\r\nfunction transformLat(x, y) {\r\n    var ret = -100 + 2 * x + 3 * y + 0.2 * y * y + 0.1 * x * y + 0.2 * sqrt(abs(x));\r\n    ret += (20 * sin(6 * x * PI) + 20 * sin(2 * x * PI)) * 2 / 3;\r\n    ret += (20 * sin(y * PI) + 40 * sin(y / 3 * PI)) * 2 / 3;\r\n    ret += (160 * sin(y / 12 * PI) + 320 * sin(y * PI / 30)) * 2 / 3;\r\n    return ret;\r\n}\r\nfunction transformLon(x, y) {\r\n    var ret = 300 + x + 2 * y + 0.1 * x * x + 0.1 * x * y + 0.1 * sqrt(abs(x));\r\n    ret += (20 * sin(6 * x * PI) + 20 * sin(2 * x * PI)) * 2 / 3;\r\n    ret += (20 * sin(x * PI) + 40 * sin(x / 3 * PI)) * 2 / 3;\r\n    ret += (150 * sin(x / 12 * PI) + 300 * sin(x / 30 * PI)) * 2 / 3;\r\n    return ret;\r\n}\r\nfunction delta(lon, lat) {\r\n    var dLon = transformLon(lon - 105, lat - 35);\r\n    var dLat = transformLat(lon - 105, lat - 35);\r\n    var radLat = lat / 180 * PI;\r\n    var magic = sin(radLat);\r\n    magic = 1 - ee * magic * magic;\r\n    var sqrtMagic = sqrt(magic);\r\n    dLon = (dLon * 180) / (a / sqrtMagic * cos(radLat) * PI);\r\n    dLat = (dLat * 180) / ((a * (1 - ee)) / (magic * sqrtMagic) * PI);\r\n    return [dLon, dLat];\r\n}\r\n// roughly check whether coordinates are in China.\r\nfunction isInChinaBbox(lon, lat) {\r\n    return lon >= 72.004 && lon <= 137.8347 && lat >= 0.8293 && lat <= 55.8271;\r\n}\r\n","dts":{"name":"D:/work/gcoord/dist/types/crs/GCJ02.d.ts","writeByteOrderMark":false,"text":"import { Position } from '../geojson';\r\nexport declare function GCJ02ToWGS84(coord: Position): Position;\r\nexport declare function WGS84ToGCJ02(coord: Position): Position;\r\n"}}
