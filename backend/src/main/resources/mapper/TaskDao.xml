<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.save.dao.TaskDao">

    <resultMap type="com.save.entity.Task" id="TaskMap">
        <result property="id" column="id" jdbcType="INTEGER"/>
        <result property="targetName" column="target_name" jdbcType="VARCHAR"/>
        <result property="targetGender" column="target_gender" jdbcType="INTEGER"/>
        <result property="targetAge" column="target_age" jdbcType="INTEGER"/>
        <result property="targetHealth" column="target_health" jdbcType="VARCHAR"/>
        <result property="targetAppearance" column="target_appearance" jdbcType="VARCHAR"/>
        <result property="targetCloth" column="target_cloth" jdbcType="VARCHAR"/>
        <result property="lostTime" column="lost_time" jdbcType="TIMESTAMP"/>
        <result property="lostPosition" column="lost_position" jdbcType="VARCHAR"/>
        <result property="familyContact" column="family_contact" jdbcType="VARCHAR"/>
        <result property="level" column="level" jdbcType="INTEGER"/>
        <result property="videoUrl" column="video_url" jdbcType="VARCHAR"/>
        <result property="imageUrl" column="image_url" jdbcType="VARCHAR"/>
        <result property="state" column="state" jdbcType="INTEGER"/>
        <result property="taskAcceptNum" column="task_accept_num" jdbcType="INTEGER"/>
        <result property="taskStartTime" column="task_start_time" jdbcType="TIMESTAMP"/>
        <result property="taskEndTime" column="task_end_time" jdbcType="TIMESTAMP"/>
    </resultMap>

    <!--查询单个-->
    <select id="queryById" resultMap="TaskMap">
        select id,
               target_name,
               target_gender,
               target_age,
               target_health,
               target_appearance,
               target_cloth,
               lost_time,
               lost_position,
               family_contact,
               level,
               video_url,
               image_url,
               state,
               task_accept_num,
               task_start_time,
               task_end_time
        from save.task
        where id = #{id}
    </select>

    <!--查询指定行数据-->
    <select id="queryAllByLimit" resultMap="TaskMap">
        select id,
               target_name,
               target_gender,
               target_age,
               target_health,
               target_appearance,
               target_cloth,
               lost_time,
               lost_position,
               family_contact,
               level,
               video_url,
               image_url,
               state,
               task_accept_num,
               task_start_time,
               task_end_time
        from save.task limit #{offset}, #{limit}
    </select>

    <!--通过实体作为筛选条件查询-->
    <select id="queryAll" resultMap="TaskMap">
        select
        id, target_name, target_gender, target_age, target_health, target_appearance, target_cloth, lost_time,
        lost_position, family_contact, level, video_url, image_url, state, task_accept_num, task_start_time,
        task_end_time
        from save.task
        <where>
            <if test="id != null">
                and id = #{id}
            </if>
            <if test="targetName != null and targetName != ''">
                and target_name = #{targetName}
            </if>
            <if test="targetGender != null">
                and target_gender = #{targetGender}
            </if>
            <if test="targetAge != null">
                and target_age = #{targetAge}
            </if>
            <if test="targetHealth != null and targetHealth != ''">
                and target_health = #{targetHealth}
            </if>
            <if test="targetAppearance != null and targetAppearance != ''">
                and target_appearance = #{targetAppearance}
            </if>
            <if test="targetCloth != null and targetCloth != ''">
                and target_cloth = #{targetCloth}
            </if>
            <if test="lostTime != null">
                and lost_time = #{lostTime}
            </if>
            <if test="lostPosition != null and lostPosition != ''">
                and lost_position = #{lostPosition}
            </if>
            <if test="familyContact != null and familyContact != ''">
                and family_contact = #{familyContact}
            </if>
            <if test="level != null">
                and level = #{level}
            </if>
            <if test="videoUrl != null and videoUrl != ''">
                and video_url = #{videoUrl}
            </if>
            <if test="imageUrl != null and imageUrl != ''">
                and image_url = #{imageUrl}
            </if>
            <if test="state != null">
                and state = #{state}
            </if>
            <if test="taskAcceptNum != null">
                and task_accept_num = #{taskAcceptNum}
            </if>
            <if test="taskStartTime != null">
                and task_start_time = #{taskStartTime}
            </if>
            <if test="taskEndTime != null">
                and task_end_time = #{taskEndTime}
            </if>
        </where>
    </select>

    <!--新增所有列-->
    <insert id="insert" keyProperty="id" useGeneratedKeys="true">
        insert into save.task(target_name, target_gender, target_age, target_health, target_appearance, target_cloth,
                              lost_time, lost_position, family_contact, level, video_url, image_url, state,
                              task_accept_num, task_start_time, task_end_time)
        values (#{targetName}, #{targetGender}, #{targetAge}, #{targetHealth}, #{targetAppearance}, #{targetCloth},
                #{lostTime}, #{lostPosition}, #{familyContact}, #{level}, #{videoUrl}, #{imageUrl}, #{state},
                #{taskAcceptNum}, #{taskStartTime}, #{taskEndTime})
    </insert>

    <insert id="insertBatch" keyProperty="id" useGeneratedKeys="true">
        insert into save.task(target_name, target_gender, target_age, target_health, target_appearance, target_cloth,
        lost_time, lost_position, family_contact, level, video_url, image_url, state, task_accept_num, task_start_time,
        task_end_time)
        values
        <foreach collection="entities" item="entity" separator=",">
            (#{entity.targetName}, #{entity.targetGender}, #{entity.targetAge}, #{entity.targetHealth},
            #{entity.targetAppearance}, #{entity.targetCloth}, #{entity.lostTime}, #{entity.lostPosition},
            #{entity.familyContact}, #{entity.level}, #{entity.videoUrl}, #{entity.imageUrl}, #{entity.state},
            #{entity.taskAcceptNum}, #{entity.taskStartTime}, #{entity.taskEndTime})
        </foreach>
    </insert>

    <insert id="insertOrUpdateBatch" keyProperty="id" useGeneratedKeys="true">
        insert into save.task(target_name, target_gender, target_age, target_health, target_appearance, target_cloth,
        lost_time, lost_position, family_contact, level, video_url, image_url, state, task_accept_num, task_start_time,
        task_end_time)
        values
        <foreach collection="entities" item="entity" separator=",">
            (#{entity.targetName}, #{entity.targetGender}, #{entity.targetAge}, #{entity.targetHealth},
            #{entity.targetAppearance}, #{entity.targetCloth}, #{entity.lostTime}, #{entity.lostPosition},
            #{entity.familyContact}, #{entity.level}, #{entity.videoUrl}, #{entity.imageUrl}, #{entity.state},
            #{entity.taskAcceptNum}, #{entity.taskStartTime}, #{entity.taskEndTime})
        </foreach>
        on duplicate key update
        target_name = values(target_name) , target_gender = values(target_gender) , target_age = values(target_age) ,
        target_health = values(target_health) , target_appearance = values(target_appearance) , target_cloth =
        values(target_cloth) , lost_time = values(lost_time) , lost_position = values(lost_position) , family_contact =
        values(family_contact) , level = values(level) , video_url = values(video_url) , image_url = values(image_url) ,
        state = values(state) , task_accept_num = values(task_accept_num) , task_start_time = values(task_start_time) ,
        task_end_time = values(task_end_time)
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        update save.task
        <set>
            <if test="targetName != null and targetName != ''">
                target_name = #{targetName},
            </if>
            <if test="targetGender != null">
                target_gender = #{targetGender},
            </if>
            <if test="targetAge != null">
                target_age = #{targetAge},
            </if>
            <if test="targetHealth != null and targetHealth != ''">
                target_health = #{targetHealth},
            </if>
            <if test="targetAppearance != null and targetAppearance != ''">
                target_appearance = #{targetAppearance},
            </if>
            <if test="targetCloth != null and targetCloth != ''">
                target_cloth = #{targetCloth},
            </if>
            <if test="lostTime != null">
                lost_time = #{lostTime},
            </if>
            <if test="lostPosition != null and lostPosition != ''">
                lost_position = #{lostPosition},
            </if>
            <if test="familyContact != null and familyContact != ''">
                family_contact = #{familyContact},
            </if>
            <if test="level != null">
                level = #{level},
            </if>
            <if test="videoUrl != null and videoUrl != ''">
                video_url = #{videoUrl},
            </if>
            <if test="imageUrl != null and imageUrl != ''">
                image_url = #{imageUrl},
            </if>
            <if test="state != null">
                state = #{state},
            </if>
            <if test="taskAcceptNum != null">
                task_accept_num = #{taskAcceptNum},
            </if>
            <if test="taskStartTime != null">
                task_start_time = #{taskStartTime},
            </if>
            <if test="taskEndTime != null">
                task_end_time = #{taskEndTime},
            </if>
        </set>
        where id = #{id}
    </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        delete
        from save.task
        where id = #{id}
    </delete>

</mapper>